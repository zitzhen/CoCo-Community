name: Sync GitHub Wiki to Gitee Wiki

on:
  push:
    branches:
      - main  # æˆ–ä½ å¸Œæœ›è§¦å‘ Wiki åŒæ­¥çš„åˆ†æ”¯

jobs:
  sync-wiki:
    runs-on: ubuntu-latest
    env:
      GITEE_USERNAME: hello-oliver
      GITEE_ORG: zitzhen
      GITEE_REPO: CoCo-Community.wiki
      GITEE_TOKEN: ${{ secrets.GITEE_TOKEN }}

    steps:
      - name: Clone GitHub Wiki repo
        run: |
          echo "ğŸš€ å…‹éš† GitHub Wiki ä»“åº“..."
          git clone --bare https://github.com/zitzhen/CoCo-Community.wiki.git wiki-repo
          cd wiki-repo

          echo "ğŸ”— æ·»åŠ  Gitee Wiki è¿œç¨‹ä»“åº“..."
          git remote remove gitee 2>/dev/null || true
          git remote add gitee "https://${GITEE_USERNAME}:${GITEE_TOKEN}@gitee.com/${GITEE_ORG}/${GITEE_REPO}.git"

          echo "âœ… éªŒè¯è¿œç¨‹ï¼š"
          git remote -v

          echo "â¬†ï¸ æ¨é€ Wiki åˆ° Gitee..."
          git push gitee --mirror || { echo "âŒ æ¨é€å¤±è´¥"; exit 1; }

          echo "ğŸ‰ Wiki æ¨é€å®Œæˆï¼"